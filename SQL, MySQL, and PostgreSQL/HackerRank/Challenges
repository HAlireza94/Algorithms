WITH NEW_TABLE AS (
    SELECT 
        HACKERS.HACKER_ID,
        HACKERS.NAME,
        COUNT(CHALLENGES.CHALLENGE_ID) AS TCID
    FROM 
        HACKERS
    LEFT JOIN 
        CHALLENGES ON CHALLENGES.HACKER_ID = HACKERS.HACKER_ID
    GROUP BY 
        HACKERS.NAME, HACKERS.HACKER_ID
), 
DUPLICATE AS (
    SELECT 
        TCID
    FROM 
        NEW_TABLE
    GROUP BY 
        TCID
    HAVING 
        COUNT(*) > 1 AND TCID < (SELECT MAX(TCID) FROM NEW_TABLE)
)

SELECT
    NEW_TABLE.HACKER_ID,
    NEW_TABLE.NAME,
    NEW_TABLE.TCID
FROM 
    NEW_TABLE
LEFT JOIN 
    DUPLICATE ON DUPLICATE.TCID = NEW_TABLE.TCID
WHERE 
    DUPLICATE.TCID IS NULL
ORDER BY 
    NEW_TABLE.TCID DESC, 
    NEW_TABLE.HACKER_ID ASC;




