WITH TASKS AS (
    SELECT
        START_DATE,
        END_DATE,
        TASK_ID,
        START_DATE - ROW_NUMBER() OVER (ORDER BY START_DATE) AS PROJECT_GROUP
    FROM PROJECTS),

PROJECT_PERIODS AS (
    SELECT
        MIN(START_DATE) AS PROJECTSTART,
        MAX(END_DATE) AS PROJECTFINISHED,
        PROJECT_GROUP
    FROM TASKS
    GROUP BY PROJECT_GROUP
)

SELECT
    PROJECTSTART,
    PROJECTFINISHED
FROM PROJECT_PERIODS
ORDER BY DATEDIFF(PROJECTFINISHED,PROJECTSTART) ASC, PROJECTSTART; 
