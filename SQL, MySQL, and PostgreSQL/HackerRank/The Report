SELECT
    CASE
    WHEN (SELECT GRADE FROM GRADES WHERE MARKS BETWEEN MIN_MARK AND MAX_MARK) >= 8 THEN NAME
    ELSE NULL
    END AS NAME,
    (SELECT GRADE FROM GRADES WHERE MARKS BETWEEN MIN_MARK AND MAX_MARK) AS GRADE,
    MARKS
FROM
STUDENTS
ORDER BY 
    GRADE DESC,
    CASE 
    WHEN GRADE >= 8 THEN NAME
    ELSE MARKS
    END ASC
    
    
